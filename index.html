<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Media Asboblari</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');
        body { font-family: 'Roboto', sans-serif; }
        .tab-active { border-bottom: 3px solid #3b82f6; color: #1d4ed8; background-color: #eff6ff; }
        .drag-area.active { border: 2px solid #3b82f6; background-color: #eff6ff; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8">

    <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden">
        
        <!-- Header -->
        <header class="bg-gradient-to-r from-blue-600 to-indigo-700 p-6 text-white text-center">
            <h1 class="text-3xl font-bold mb-2"><i class="fas fa-tools mr-2"></i>Universal Media Asboblari</h1>
            <p class="opacity-90">Rasm konvertatsiya qilish va Matn tahlili â€“ Barchasi bittada</p>
        </header>

        <!-- Tabs -->
        <div class="flex border-b">
            <button onclick="switchTab('image')" id="tab-image" class="w-1/2 py-4 text-center font-semibold text-gray-600 hover:bg-gray-50 transition tab-active">
                <i class="fas fa-image mr-2"></i>Rasm Konverter (JPG/PNG)
            </button>
            <button onclick="switchTab('text')" id="tab-text" class="w-1/2 py-4 text-center font-semibold text-gray-600 hover:bg-gray-50 transition">
                <i class="fas fa-file-alt mr-2"></i>Matn Muharriri
            </button>
        </div>

        <!-- Content Area -->
        <div class="p-6 md:p-8">

            <!-- IMAGE CONVERTER SECTION -->
            <div id="image-section" class="space-y-6">
                <div class="text-center space-y-2">
                    <h2 class="text-xl font-bold text-gray-800">Rasm formatini o'zgartirish</h2>
                    <p class="text-gray-500 text-sm">JPG, PNG, WEBP formatlari o'rtasida konvertatsiya qiling</p>
                </div>

                <!-- Drag & Drop Area -->
                <div id="drag-area" class="drag-area border-2 border-dashed border-gray-300 rounded-xl p-10 text-center cursor-pointer transition hover:bg-gray-50" onclick="document.getElementById('file-input').click()">
                    <input type="file" id="file-input" class="hidden" accept="image/*">
                    <div id="upload-content">
                        <i class="fas fa-cloud-upload-alt text-5xl text-blue-400 mb-3"></i>
                        <p class="text-lg font-medium text-gray-700">Rasmni tanlang yoki shu yerga tashlang</p>
                        <p class="text-xs text-gray-400 mt-1">Maksimal hajmi: 10MB</p>
                    </div>
                    <div id="preview-container" class="hidden">
                        <img id="image-preview" class="max-h-64 mx-auto rounded-lg shadow-md mb-4" src="" alt="Preview">
                        <p id="file-name" class="text-sm font-semibold text-gray-700"></p>
                        <p id="file-size" class="text-xs text-gray-500"></p>
                        <button onclick="resetImage(event)" class="mt-3 text-red-500 hover:text-red-700 text-sm font-medium underline">Boshqa rasm tanlash</button>
                    </div>
                </div>

                <!-- Controls -->
                <div id="controls" class="hidden bg-gray-50 p-4 rounded-xl border border-gray-200">
                    <div class="flex flex-col md:flex-row gap-4 items-center justify-between">
                        <div class="w-full md:w-1/2">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Qaysi formatga o'tkazasiz?</label>
                            <select id="format-select" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none">
                                <option value="image/jpeg">JPG (JPEG)</option>
                                <option value="image/png">PNG (Shaffof fon uchun)</option>
                                <option value="image/webp">WEBP (Web uchun)</option>
                            </select>
                        </div>
                        <div class="w-full md:w-1/2">
                            <button onclick="convertAndDownload()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2.5 rounded-lg shadow transition transform hover:scale-[1.02]">
                                <i class="fas fa-download mr-2"></i>Konvertatsiya va Yuklash
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Hidden Canvas for Processing -->
                <canvas id="canvas" class="hidden"></canvas>
            </div>


            <!-- TEXT TOOLS SECTION -->
            <div id="text-section" class="hidden space-y-6">
                <div class="flex justify-between items-end">
                    <h2 class="text-xl font-bold text-gray-800">Matn Tahlili</h2>
                    <div class="flex gap-2">
                         <button onclick="copyText()" class="text-gray-500 hover:text-blue-600 text-sm bg-gray-100 px-3 py-1 rounded"><i class="fas fa-copy mr-1"></i>Nusxa olish</button>
                         <button onclick="clearText()" class="text-gray-500 hover:text-red-600 text-sm bg-gray-100 px-3 py-1 rounded"><i class="fas fa-trash mr-1"></i>Tozalash</button>
                    </div>
                </div>

                <textarea id="text-input" class="w-full h-48 p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:outline-none resize-none" placeholder="Matnni shu yerga yozing yoki joylang..."></textarea>

                <!-- Statistics -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="bg-blue-50 p-3 rounded-lg text-center border border-blue-100">
                        <span id="char-count" class="block text-2xl font-bold text-blue-600">0</span>
                        <span class="text-xs text-gray-500 uppercase font-semibold">Belgilar</span>
                    </div>
                    <div class="bg-green-50 p-3 rounded-lg text-center border border-green-100">
                        <span id="word-count" class="block text-2xl font-bold text-green-600">0</span>
                        <span class="text-xs text-gray-500 uppercase font-semibold">So'zlar</span>
                    </div>
                    <div class="bg-purple-50 p-3 rounded-lg text-center border border-purple-100">
                        <span id="sentence-count" class="block text-2xl font-bold text-purple-600">0</span>
                        <span class="text-xs text-gray-500 uppercase font-semibold">Gaplar</span>
                    </div>
                    <div class="bg-orange-50 p-3 rounded-lg text-center border border-orange-100">
                        <span id="reading-time" class="block text-2xl font-bold text-orange-600">0</span>
                        <span class="text-xs text-gray-500 uppercase font-semibold">Sekund o'qish</span>
                    </div>
                </div>

                <!-- Actions -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3 pt-4 border-t">
                    <button onclick="textToSpeech()" class="bg-gray-800 text-white p-3 rounded-lg hover:bg-gray-900 transition flex items-center justify-center gap-2">
                        <i class="fas fa-volume-up"></i> Ovozli o'qish
                    </button>
                    <button onclick="toUpperCase()" class="bg-white border border-gray-300 text-gray-700 p-3 rounded-lg hover:bg-gray-50 transition font-bold">
                        AA (KATTA)
                    </button>
                    <button onclick="toLowerCase()" class="bg-white border border-gray-300 text-gray-700 p-3 rounded-lg hover:bg-gray-50 transition lowercase font-bold">
                        aa (kichik)
                    </button>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- TAB SWITCHING ---
        function switchTab(tab) {
            const imgSec = document.getElementById('image-section');
            const txtSec = document.getElementById('text-section');
            const imgTab = document.getElementById('tab-image');
            const txtTab = document.getElementById('tab-text');

            if (tab === 'image') {
                imgSec.classList.remove('hidden');
                txtSec.classList.add('hidden');
                imgTab.classList.add('tab-active');
                txtTab.classList.remove('tab-active');
            } else {
                imgSec.classList.add('hidden');
                txtSec.classList.remove('hidden');
                imgTab.classList.remove('tab-active');
                txtTab.classList.add('tab-active');
            }
        }

        // --- IMAGE CONVERTER LOGIC ---
        const dropArea = document.getElementById('drag-area');
        const fileInput = document.getElementById('file-input');
        const uploadContent = document.getElementById('upload-content');
        const previewContainer = document.getElementById('preview-container');
        const imagePreview = document.getElementById('image-preview');
        const fileName = document.getElementById('file-name');
        const fileSize = document.getElementById('file-size');
        const controls = document.getElementById('controls');
        let currentImageFile = null;

        // Drag & Drop events
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) { e.preventDefault(); e.stopPropagation(); }

        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, () => dropArea.classList.add('active'), false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, () => dropArea.classList.remove('active'), false);
        });

        dropArea.addEventListener('drop', handleDrop, false);
        fileInput.addEventListener('change', (e) => handleFiles(e.target.files));

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }

        function handleFiles(files) {
            if (files.length > 0) {
                const file = files[0];
                if (!file.type.startsWith('image/')) {
                    alert("Iltimos, faqat rasm yuklang!");
                    return;
                }
                currentImageFile = file;
                previewImage(file);
            }
        }

        function previewImage(file) {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onloadend = function() {
                imagePreview.src = reader.result;
                fileName.textContent = file.name;
                fileSize.textContent = (file.size / 1024).toFixed(2) + ' KB';
                uploadContent.classList.add('hidden');
                previewContainer.classList.remove('hidden');
                controls.classList.remove('hidden');
            }
        }

        function resetImage(e) {
            e.stopPropagation();
            fileInput.value = '';
            currentImageFile = null;
            uploadContent.classList.remove('hidden');
            previewContainer.classList.add('hidden');
            controls.classList.add('hidden');
        }

        function convertAndDownload() {
            if (!currentImageFile) return;

            const format = document.getElementById('format-select').value;
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            const img = new Image();

            img.onload = function() {
                canvas.width = img.width;
                canvas.height = img.height;
                // Oq fon qo'shish (PNG dan JPG ga o'tkazganda qora fon bo'lmasligi uchun)
                if (format === 'image/jpeg') {
                    ctx.fillStyle = "#FFFFFF";
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                }
                ctx.drawImage(img, 0, 0);

                const dataURL = canvas.toDataURL(format, 0.9); // 0.9 sifat
                const link = document.createElement('a');
                
                // Yangi fayl nomini yasash
                const originalName = currentImageFile.name.split('.')[0];
                const ext = format.split('/')[1];
                link.download = `${originalName}_converted.${ext}`;
                
                link.href = dataURL;
                link.click();
            }
            img.src = imagePreview.src;
        }

        // --- TEXT TOOLS LOGIC ---
        const textInput = document.getElementById('text-input');
        const charCount = document.getElementById('char-count');
        const wordCount = document.getElementById('word-count');
        const sentenceCount = document.getElementById('sentence-count');
        const readingTime = document.getElementById('reading-time');

        textInput.addEventListener('input', updateStats);

        function updateStats() {
            const text = textInput.value;
            
            // Belgilar
            charCount.innerText = text.length;

            // So'zlar
            const words = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
            wordCount.innerText = words;

            // Gaplar (., !, ? bilan tugagan)
            const sentences = text.trim() === '' ? 0 : text.split(/[.!?]+/).filter(Boolean).length;
            sentenceCount.innerText = sentences;

            // O'qish vaqti (o'rtacha 200 so'z/daqiqada)
            const seconds = Math.ceil(words / 3.3); // 200 so'z / 60 sek ~ 3.3
            readingTime.innerText = seconds + " sek";
        }

        function toUpperCase() {
            textInput.value = textInput.value.toUpperCase();
            updateStats();
        }

        function toLowerCase() {
            textInput.value = textInput.value.toLowerCase();
            updateStats();
        }

        function clearText() {
            if(confirm("Tozalansinmi?")) {
                textInput.value = "";
                updateStats();
            }
        }

        function copyText() {
            textInput.select();
            document.execCommand('copy');
            alert("Nusxa olindi!");
        }

        function textToSpeech() {
            const text = textInput.value;
            if (!text) return;
            
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                // Ovozni sozlash (agar mavjud bo'lsa)
                // utterance.lang = 'uz-UZ'; // Brauzer qo'llab quvvatlasa
                window.speechSynthesis.speak(utterance);
            } else {
                alert("Brauzeringiz ovozli o'qishni qo'llab quvvatlamaydi.");
            }
        }

    </script>
</body>
</html>


